<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Webgazer</title>
</head>

<body>

    <style>
        body{
            background-image: url('test.svg');
        }
        
        button {
            float: right !important;
        }

    </style>

    <div onclick="saveGaze()">
        <button>Save</button>
    </div>

    <div onclick="webgazer.resume()">
        <button>Resume</button>
    </div>

    <div onclick="webgazer.pause()">
        <button>Pause</button>
    </div>

    <div onclick="recordGaze()">
        <button>Start</button>
    </div>

    <script>
        // this array will store all the eye movements
        var x = [];

        // start recording
        function recordGaze() {
            webgazer.setGazeListener(function (data, elapsedTime) {
                if (data == null) {
                    return;
                }
                var xprediction = data.x; 
                var yprediction = data.y;
                x.push([xprediction, yprediction]);
                console.log(xprediction + "," + yprediction);
            }).begin();
        }

        // exporting data to .csv file
        function saveGaze() {
            console.log(x);

            var csv = '';
            x.forEach(function (row) {
                csv += row.join(',');
                csv += "\n";
            });


            var hiddenElement = document.createElement('a');
            hiddenElement.href = 'data:text/csv;charset=utf-8,' + encodeURI(csv);
            hiddenElement.target = '_blank';
            hiddenElement.download = 'gazeData.csv';
            hiddenElement.click();
        }
    </script>
    
</body>


<script src="webgazer.js" type="text/javascript">
</script>

</html>